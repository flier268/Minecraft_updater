<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Minecraft_updater.ViewModels"
        xmlns:views="using:Minecraft_updater.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="700"
        x:Class="Minecraft_updater.Views.UpdatepackMakerWindow"
        x:DataType="vm:UpdatepackMakerWindowViewModel"
        Title="Minecraft Updater - Pack Maker"
        Icon="/Assets/minecraft_updater.ico"
        Width="900" Height="700"
        MinWidth="600" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        DragDrop.AllowDrop="True">

    <Design.DataContext>
        <vm:UpdatepackMakerWindowViewModel />
    </Design.DataContext>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 選單 -->
        <Menu Grid.Row="0" Margin="0,0,0,10">
            <MenuItem Header="Files">
                <MenuItem Header="Load" Click="OnLoadClick"/>
            </MenuItem>
        </Menu>

        <!-- Base Path 和 Base URL 輸入 -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Spacing="10">
                <!-- Base Path -->
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="Base Path:" VerticalAlignment="Center" Width="80"/>
                    <TextBox Text="{Binding BasePath}"
                             Width="380"
                             IsReadOnly="True"
                             Watermark="請選取基礎目錄..."/>
                    <Button Content="選取目錄" Click="OnSelectBasePathClick"/>
                </StackPanel>

                <!-- Base URL -->
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="Base URL:" VerticalAlignment="Center" Width="80"/>
                    <TextBox Text="{Binding BaseUrl}"
                             Width="380"
                             Watermark="http://example.com/"/>
                </StackPanel>

                <!-- Authentication -->
                <Border BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                        BorderThickness="1"
                        Padding="10"
                        Margin="0,0,0,10">
                    <StackPanel Spacing="8">
                        <TextBlock Text="下載來源身份驗證" FontWeight="Bold"/>

                        <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                            <TextBlock Text="驗證模式：" VerticalAlignment="Center"/>
                            <ComboBox ItemsSource="{Binding AuthenticationModes}"
                                      SelectedItem="{Binding SelectedAuthMode}"
                                      Grid.Column="1"
                                      MinWidth="200"/>
                        </Grid>

                        <StackPanel IsVisible="{Binding ShowBasicFields}" Spacing="6">
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="使用者名稱：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthUsername, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="帳號"/>
                            </Grid>
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="密碼：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthPassword, UpdateSourceTrigger=PropertyChanged}"
                                         PasswordChar="*"
                                         Watermark="密碼"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel IsVisible="{Binding ShowBearerTokenField}" Spacing="6">
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="Bearer Token：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthBearerToken, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="請輸入 Token"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel IsVisible="{Binding ShowHeaderFields}" Spacing="6">
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="Header 名稱：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthHeaderName, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="例如 X-API-Key"/>
                            </Grid>
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="Header 值：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthHeaderValue, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="請輸入憑證值"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel IsVisible="{Binding ShowQueryFields}" Spacing="6">
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="參數名稱：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthQueryName, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="例如 token"/>
                            </Grid>
                            <Grid ColumnDefinitions="120,*" ColumnSpacing="10">
                                <TextBlock Text="參數值：" VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1"
                                         Text="{Binding AuthQueryValue, UpdateSourceTrigger=PropertyChanged}"
                                         Watermark="請輸入參數值"/>
                            </Grid>
                        </StackPanel>

                        <TextBlock Text="所有檔案下載都會套用此身份驗證設定"
                                   Foreground="Gray"
                                   IsVisible="{Binding ShowAuthDetails}"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <Border Grid.Column="1"
                    BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                    BorderThickness="1"
                    Padding="10"
                    Margin="10,0,0,0">
                <StackPanel>
                    <TextBlock Text="特殊設定" FontWeight="Bold" Margin="0,0,0,5"/>
                    <CheckBox Content="將&quot;mod&quot;下的檔案加入刪除清單"
                              IsChecked="{Binding AddModToDelete}"/>
                    <CheckBox Content="將&quot;config&quot;下的檔案加入刪除清單"
                              IsChecked="{Binding AddConfigToDelete}"
                              Margin="0,5,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <TextBlock Grid.Row="2" Text="提示：將檔案或資料夾拖曳到下方的文字框中"
                   Foreground="Gray" Margin="0,0,0,5"/>

        <!-- 同步清單 -->
        <views:FileListControl Grid.Row="3"
                               x:Name="SyncListControl"
                               Title="同步清單"
                               ListText="{Binding SyncListText}"
                               ClearCommand="{Binding ClearSyncListCommand}"
                               ListIndex="0"/>

        <!-- 刪除清單 -->
        <views:FileListControl Grid.Row="4"
                               x:Name="DeleteListControl"
                               Title="刪除清單"
                               ListText="{Binding DeleteListText}"
                               ClearCommand="{Binding ClearDeleteListCommand}"
                               ListIndex="1"/>

        <!-- 不存在則添加清單 -->
        <views:FileListControl Grid.Row="5"
                               x:Name="DownloadWhenNotExistListControl"
                               Title="不存在則添加清單"
                               ListText="{Binding DownloadWhenNotExistText}"
                               ClearCommand="{Binding ClearDownloadWhenNotExistListCommand}"
                               ListIndex="2"/>

        <!-- 儲存按鈕 -->
        <Button Grid.Row="6"
                Content="儲存"
                HorizontalAlignment="Center"
                Padding="20,8"
                MinWidth="100"
                Click="OnSaveClick"/>
    </Grid>
</Window>
